Свёрточная нейронная сеть (convolutional neural network, CNN) – специальная архитектура искусственных нейронных сетей, нацеленная на эффективное распознавание изображений. Основная архитектурная особенность сверточных нейронных сетей заключается в чередовании двух типов слоев: сверточных слоев (convolution layers) и субдискретизирующих слоев (subsampling layers или pooling layers). Такая архитектура нейросети хорошо улавливает локальный контекст, когда информация в пространстве непрерывна, то есть её носители находятся рядом. Например, пиксели – части изображения, которые расположены близко друг к другу и содержат визуальные данные: яркость и цвет. Это принципиально многослойные и однонаправленные (без обратных связей) нейронные сети, для обучения которых используются стандартные методы, чаще всего метод обратного распространения ошибки. Необходимо отметить, что идея сверточных нейронных сетей основана на некоторых особенностях зрительной коры, в которой были открыты так называемые простые клетки, реагирующие на прямые линии под разными углами, и сложные клетки, реакция которых связана с активацией определенного набора простых клеток. Название эта архитектура сети получила из-за наличия операции свертки, суть которой в том, что каждый фрагмент изображения умножается на матрицу (ядро) свертки поэлементно, а результат суммируется и записывается в аналогичную позицию выходного изображения (см. рис. 66). Рис. 66. Сверточная нейронная сеть В операции свёртки используется ограниченная матрица весов небольшого размера, которую «двигают» по всему обрабатываемому слою (в самом начале – непосредственно по входному изображению), формируя после каждого сдвига сигнал активации для нейрона следующего слоя с аналогичной позицией. Для различных нейронов выходного слоя используется одна и та же матрица весов, которую также называют ядром свёртки. Ядро свёртки интерпретируют как графическое кодирование какого-либо признака, например, наличие наклонной линии под определенным углом. 67 Следующий слой, получившийся в результате операции свертки такой матрицей весов, показывает наличие данного признака в обрабатываемом слое и его координаты, формируя так называемую карту признаков (feature map). При этом такие ядра свертки не закладываются исследователем заранее, а формируются самостоятельно путем обучения сети классическим методом обратного распространения ошибки. Проход каждым набором весов формирует свой собственный экземпляр карты признаков, делая нейронную сеть многоканальной (много независимых карт признаков на одном слое). Таким образом слой свертки – это основной блок сверточной нейронной сети. Слой свёртки включает в себя для каждого канала свой фильтр, ядро свертки которого обрабатывает предыдущий слой по фрагментам (суммируя результаты матричного произведения для каждого фрагмента). Весовые коэффициенты ядра свертки (небольшой матрицы) неизвестны и устанавливаются в процессе обучения. Особенностью сверточного слоя является сравнительно небольшое количество параметров, устанавливаемое при обучении. Например, если исходное изображение имеет размерность 100×100 пикселей по трём каналам (это значит – 30000 входных нейронов), а сверточный слой использует фильтры c ядром 3x3 пикселя с выходом на 6 каналов, тогда в процессе обучения определяется только 9 весов ядра, однако по всем сочетаниям каналов, то есть 9×3×6 =162, в таком случае данный слой требует нахождения только 162 параметров, что существенно меньше количества искомых параметров полносвязной нейронной сети (см. рис. 67). Рис. 67. Графическая изображения операций сверточного слоя 68 После сверточных слоев обычно используется слой ReLU (rectified linear unit), который графически выглядит как линейная функция с нулевым отсечением на оси абсцисс в точке 0 (см. рис. 68). Это значит, что функция имеет постоянный наклон во всех точках, кроме точки 0, где происходит отсечение. Такая функция показывает хорошие результаты при обучении нейронных сетей и отвечает за отсечение ненужных деталей в канале (например, при отрицательном выходе). Рис. 68. График функции ReLU Сверточные нейронные сети также содержат слои пулинга (подвыборки, субдискретизации), которые выполняют нелинейное уплотнение карты признаков, при этом группа пикселей (обычно размера 2×2) уплотняется до одного пикселя, проходя нелинейное преобразование (см. рис. 69). Преобразования затрагивают непересекающиеся прямоугольники или квадраты, каждый из которых ужимается в один пиксель, при этом выбирается пиксель, имеющий максимальное значение. Операция пулинга позволяет существенно уменьшить пространственный объём изображения. Пулинг интерпретируется следующим образом. Если на предыдущей операции свёртки уже были выявлены некоторые признаки, то для дальнейшей обработки настолько подробное изображение уже не нужно, и оно уплотняется до менее подробного. Слой пулинга, как правило, вставляется после слоя свёртки перед слоем следующей свёртки. В целях более агрессивного уменьшения размера получаемых представлений всё чаще находят распространение идеи использования меньших фильтров или полный отказ от слоёв пулинга. 69 Рис. 69. Пулинг с функцией максимума и фильтром 2×2 с шагом 2 После нескольких прохождений свёртки изображения и уплотнения с помощью пулинга система перестраивается от конкретной сетки пикселей с высоким разрешением к более абстрактным картам признаков; как правило, на каждом следующем слое увеличивается число каналов и уменьшается размерность изображения в каждом канале. В конце концов остаётся большой набор каналов, хранящих небольшое число данных, которые интерпретируются как самые абстрактные понятия, выявленные из исходного изображения. Эти данные объединяются и передаются на обычную полносвязную нейронную сеть, которая тоже может состоять из нескольких слоёв (см. рис. 70). При этом полносвязные слои уже утрачивают пространственную структуру пикселей и обладают сравнительно небольшой размерностью (по отношению к количеству пикселей исходного изображения).